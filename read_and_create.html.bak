<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<title>无标题文档</title>
<script src="ajax.js"></script>
<script>
window.onload=function ()
{
	var oBtn=document.getElementById('btn1');
	var oBtn2=document.getElementById('btn2');
	var oUl=document.getElementById('ul1');
	
	oBtn.onclick=function ()
	{
		ajax('data.txt?t='+new Date().getTime(), function (str){
			var arr=eval(str);


			var sum=1;
			for(var i=0;i<arr.length;i++)
			{
				if(arr[i].user==oBtn2.value)
				{
				 sum=sum+1;

				}
				else if(oBtn2.value=='')
				{
                    sum=0;
				}
				else
				{
                  sum=sum;
				}
			
			}

			if(sum>1)
			{
			  alert('该用户已存在');
			}
			else if(sum==0)
			{
			alert('用户名不能为空');
			}
			else
			{
			alert('用户名不能为空');
			}

			
		}, function (){
			alert('失败');
		});
	};
};
</script>
</head>

<body>
<input id="btn2" type="text"/>
<input id="btn1" type="button" value="验证" />
<ul id="ul1">
</ul>
</body>
</html>
